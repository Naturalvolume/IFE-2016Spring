# 当不加分号时
在编写 js 时，可以加分号，也可以不加分号。这是因为不加分号时，编译器会自动在 缺少分号就无法正确解析代码时，填补分号。

```javascript
// 例子1：当发现无法解析时，才会自动加上分号
var a
a
=
3
console.log(a)
// 填充为 var a; a = 3; console.log(a);

// 例子2：不加分号，导致的不良结果
var y = x + f
(a+b).toString()
// 填充为： var y = x + f(a+b).toString()
```

### ASI（Automatic semicolon insertion）
ASI 机制允许省略分号，**并不是在解析过程中解析器自动把分号添加到代码中**，而是解析器以换行为基础按一定规则作为断句的依据，保证解析的正确性。

- 新行并入当前行构成非法语句时，自动插入分号
- 代码块的最后一个语句会自动插入分号
- 注意：新行以`( [ / + = * % , .`开始，很容易与上一行未加分号的代码成整体而一起解析，造成错误（如上面的例子2）
- 两种最好加分号的情况
  - continue、return、break、throw 后自动插入分号
  - ++、-- 都以后缀表达式作为新行开始，会在行首自动插入分号

```javascript
// 例子3:return 自动加分号
return
true
// 转换成：return; true;

// 例子4: ++运算符跟下一行链接
x
++
y
// 转换成：x; ++y;
// 在我们希望是 x++ 时，会处理错误
```

所以在不加分号时，需要注意：
- 不要将 ++ 或 -- 放在同一行
- 若 return 后有参数，不要将参数放在独立的行
- 不要将括号的开始放在新的一行，否则可能会跟上一行合并
