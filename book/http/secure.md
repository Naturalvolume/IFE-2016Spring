# web安全
### XSS(跨站脚本攻击)
### CSRF(跨站请求攻击)
### SQL注入
拼接SQL时未仔细过滤，黑客提交畸形数据改变语义。如提交`id=-1 or 1=1`，`1=1`永远是true，所以where语句永远是true，那么查询结果等于整张表的内容，攻击者就达到了目的。

**预防策略**：
- 禁止目标网站利用动态拼接字符串的方式访问数据库
- 减少不必要的数据库抛出的错误信息
- 对数据库的操作赋予严格的权限控制
- 净化和过滤不必要的SQL保留字，如 where、or、exec等

### 点击劫持
- 诱导用户点击看似无害按钮，实则点击了透明iframe中的按钮
- 监听鼠标移动事件，让危险按钮始终在鼠标下方
- 使用html5拖曳技术执行敏感操作（如 deploy key）

**预防策略**：
- 服务器添加`X-Frame-Options`响应头，让浏览器阻止嵌入网页的渲染
- js判断顶层视口的域名是否和本页面的域名一致，不一致就不允许操作，`top.location.hostname === self.location.hostname`
- 敏感操作使用更复杂的步骤（验证码、输入项目名称以删除）

### window.opener安全问题
window.opener表示当前打开窗体页面的父窗体是谁。例如，在 A 页面中，通过一个带有 target="_blank" 的 a 标签打开了一个新的页面 B，那么在 B 页面里，window.opener 的值为 A 页面的 window 对象。

一般来说，打开同源(域名相同)的页面，不会有什么问题。但对于跨域的外部链接来说，存在一个被钓鱼的风险。比如你正在浏览购物网站，**从当前网页打开了某个外部链接，在打开的外部页面，可以通过 window.opener.location 改写来源站点的地址**。利用这一点，将来源站点改写到钓鱼站点页面上，例如跳转到伪造的高仿购物页面，当再回到购物页面的时候，是很难发现购物网站的地址已经被修改了的，这个时候你的账号就存在被钓鱼的可能了。

**预防策略**：
- 设置 rel 属性
```javascript
<a href="https://xxxx" rel="noopener noreferrer"> 外链 <a>
```

rel=noopener 规定禁止新页面传递源页面的地址，通过设置了此属性的链接打开的页面，其 window.opener 的值为 null。
- 将外链替换为内部的跳转连接服务，跳转时先跳到内部地址，再由服务器 redirect 到外链
- 由 widow.open 打开外链

### 文件上传漏洞
服务器未校验上传的文件，致使黑客可以上传恶意脚本。
**预防策略**：
- 用文件头检测文件类型，使用白名单过滤（有些文件可以从其中一部分执行，只检查文件头无效，例如php等脚本语言）
- 上传后将文件彻底重命名并移动到不可执行的目录下
- 升级服务器软件避免路径解析漏洞
- 升级用到的开源编辑器
- 管理后台设置强密码

参考：[Web 安全总结(面试必备良药)](https://mp.weixin.qq.com/s/rU32rVM6Q-ele01ZB3RFzg)